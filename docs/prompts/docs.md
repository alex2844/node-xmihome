# Умная актуализация документации

Ты — эксперт по технической документации и shell-скриптингу.
Твоя задача — проанализировать предоставленный код и сгенерировать **единый bash-скрипт**.
Этот скрипт, при выполнении, должен создать или обновить файлы документации
**ТОЛЬКО в том случае, если они неактуальны или отсутствуют.**

**ПРАВИЛА АНАЛИЗА:**

1. **Сравнивай существующую документацию с кодом.** Если файл документации
не предоставлен, считай, что его нужно создать.
2. **Игнорируй стилистические различия.** Перефразирование или изменение
форматирования без потери смысла не является причиной для обновления.
3. **Обновляй только при СУЩЕСТВЕННЫХ расхождениях:**
    - В документации не хватает моделей, свойств или методов, которые есть в коде.
    - В документации описано то, чего в коде уже нет.
    - Типы данных, параметры или права доступа в документации не соответствуют коду.
4. **Источник правды — код.** JSDoc используй только для текстовых описаний.

**ПРАВИЛА ГЕНЕРАЦИИ СКРИПТА:**

1. **Вывод — это bash-скрипт.** Ничего лишнего. Начинай с `#!/bin/bash`
и добавляй `set -e` для безопасности.
2. **Создавай директории.** Перед записью файла убедись,
что директория существует (`mkdir -p ...`).
3. **Используй `cat <<'EOF' > file.path` для записи.**
Это самый надежный способ записи многострочного текста.
4. **Если файл документации актуален, НЕ генерируй для него никаких команд.**
В итоговом скрипте должны быть команды только для тех файлов,
которые нужно создать или изменить.
5. **Выводи комментарии в скрипте**, поясняющие,
какой файл обновляется (`# Обновление документации для устройства X...`).
6. **Следуй структуре файлов**, описанной в задачах ниже
(генерация на русском, перевод на английский, правильное размещение).

**ЗАДАЧИ ДЛЯ ВЫПОЛНЕНИЯ ВНУТРИ СКРИПТА:**

**1. Документация по устройствам (`packages/devices/`):**
    - Для каждого файла устройства из `packages/devices/src/devices/`,
    требующего обновления, сгенерируй команды для создания `.md` файла
    на русском и английском.
    - Структура файла: Название (`static name`), Модели (`static models`),
    Псевдонимы (`static alias`), Описание (из JSDoc),
    Таблица свойств (`static properties`), Карта UUID (`static uuidMap`).
    Документации должны быть в едином стиле.
    - Русский файл -> `packages/devices/docs/ru/FILENAME.md`
    - Английский файл -> `packages/devices/docs/en-US/FILENAME.md`

**2. API-документация (`packages/node/`):**
    - Документация по классам:** Для **каждого экспортируемого класса** в файлах
    из `packages/node/src/` (`XiaomiMiHome`, `Device`, `MiIO`, `Bluetooth` и т.д.),
    если его публичный API изменился, сгенерируй команды для создания `.md` файла.
    - Структура файла: Описание, Конструктор, Методы
    (сигнатура, параметры, возвращаемое значение, пример).
    - Русский файл -> `packages/node/docs/ru/api/FILENAME.md`
    - Английский файл -> `packages/node/docs/en-US/api/FILENAME.md`

**3. Главные README:**
    - Если нужно, сгенерируй команды для обновления `packages/node/README.md` и
    `packages/node-red/README.md` (английские версии для NPM).
    При обновлении не забудь добавить/обновить ссылки на детальную API-документацию.
    - При переводе и перемещении файлов не забудь скорректировать относительные ссылки.
