# Класс: Miot

Класс для взаимодействия с облаком Xiaomi и устройствами по протоколу MiIO. Обычно используется внутренне клиентом `XiaomiMiHome`.

## Статические методы

### `findModel(model)`

Ищет спецификацию устройства на `miot-spec.org` по его модели.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `model` | `string` | Модель устройства (например, `deerma.humidifier.jsq2w`). |

**Возвращает:**

- `Promise<object|undefined>`: Промис, который разрешается объектом спецификации, или `undefined`, если модель не найдена.

## Свойства

| Имя | Тип | Описание |
|---|---|---|
| `credentials` | `object` | Предоставляет доступ к облачным учетным данным (`username`, `password`, `country` и т.д.) из основной конфигурации клиента. |
| `miio` | `object` | Прямой доступ к библиотеке `mijia-io` для низкоуровневых операций с MiIO. |

## Методы

### `login()`

Выполняет вход в аккаунт Xiaomi для получения токенов, необходимых для облачных запросов. Вызывается автоматически при первом запросе к облаку.

**Возвращает:**

- `Promise<void>`

### `request(path, data)`

Выполняет подписанный запрос к облачному API Xiaomi.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `path` | `string` | Путь API-эндпоинта (например, `/home/device_list`). |
| `data` | `object` | Объект с данными для отправки. |

**Возвращает:**

- `Promise<object>`: Промис, который разрешается JSON-ответом от сервера.

### `parseJson(str)`

Разбирает JSON-строку, удаляя префикс `&&&START&&&`, если он есть.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `str` | `string` | JSON-строка. |

**Возвращает:**

- `object`: Разобранный JSON-объект.

### `getApiUrl(country)`

Возвращает URL API для указанной страны.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `country` | `string` | Код страны (например, `ru`, `cn`). |

**Возвращает:**

- `string`: URL API.

### `generateSignature(path, _signedNonce, nonce, params)`

Генерирует подпись запроса для облачного API Xiaomi.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `path` | `string` | Путь API-запроса. |
| `_signedNonce` | `string` | Подписанный nonce. |
| `nonce` | `string` | Nonce. |
| `params` | `object` | Параметры запроса. |

**Возвращает:**

- `string`: Подпись запроса в base64.

### `generateNonce()`

Генерирует nonce для запросов к облачному API Xiaomi.

**Возвращает:**

- `string`: Nonce в base64.

### `signedNonce(ssecret, nonce)`

Генерирует подписанный nonce.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `ssecret` | `string` | Токен `ssecurity`. |
| `nonce` | `string` | Nonce. |

**Возвращает:**

- `string`: Подписанный nonce в base64.
