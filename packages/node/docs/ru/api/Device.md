# Класс: Device

Базовый класс для всех устройств Xiaomi. Предоставляет унифицированный интерфейс для подключения, управления свойствами и подписки на уведомления.

Экземпляры этого класса обычно создаются через метод `XiaomiMiHome.getDevice()`.

## Свойства

| Имя | Тип | Описание |
|---|---|---|
| `connectionType` | `string` | Текущий тип подключения (`'miio'`, `'bluetooth'`, `'cloud'`) или `undefined`, если не подключено. |
| `isConnected` | `boolean` | `true`, если устройство в данный момент подключено. |
| `isConnecting` | `boolean` | `true`, если устройство находится в процессе первоначального подключения. |
| `isReconnecting` | `boolean` | `true`, если устройство находится в процессе автоматического переподключения. |
| `properties` | `object` | Объект, содержащий определения всех свойств устройства. |

## События

Экземпляры класса `Device` генерируют следующие события:

| Событие | Данные | Описание |
|---|---|---|
| `connected` | `string` (connectionType) | Генерируется при успешном установлении соединения с устройством. |
| `disconnect` | - | Генерируется при разрыве соединения, как при вызове `disconnect()`, так и по внешним причинам. |
| `reconnecting` | `{ reason: string }` | Генерируется, когда начинается процесс автоматического переподключения после неожиданного разрыва связи. |
| `reconnect_failed` | `{ attempts: number, error?: string }` | Генерируется, когда процесс автоматического переподключения завершается неудачей после всех попыток. |

## Методы

### `connect(connectionType)`

Устанавливает соединение с устройством. Тип подключения определяется автоматически, если не указан явно. Метод отдает приоритет аргументу `connectionType`, затем использует настройку по умолчанию из клиента и в последнюю очередь пытается определить тип автоматически по доступным данным устройства.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `connectionType` | `string` | (Опционально) Предпочитаемый тип подключения (`'miio'`, `'bluetooth'`, `'cloud'`). |

**Возвращает:**

- `Promise<void>`

### `disconnect()`

Разрывает соединение с устройством.

**Возвращает:**

- `Promise<void>`

### `getName()`

Получает имя устройства.

**Возвращает:**

- `string`: Имя устройства.

### `getModel()`

Получает идентификатор модели устройства.

**Возвращает:**

- `string`: Строка модели устройства.

### `getProperty(prop)`

Получает значение одного свойства.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `prop` | `string` | Имя свойства для получения. |

**Возвращает:**

- `Promise<any>`: Промис, который разрешается значением свойства.

### `getProperties(properties)`

Получает значения нескольких свойств. Если `properties` не указан, запрашивает все читаемые свойства.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `properties` | `string[]` | (Опционально) Массив имен свойств для получения. |

**Возвращает:**

- `Promise<object>`: Промис, который разрешается объектом `{ propertyName: value, ... }`.

### `setProperty(prop, value)`

Устанавливает значение для одного свойства.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `prop` | `string` | Имя свойства для установки. |
| `value` | `any` | Новое значение для свойства. |

**Возвращает:**

- `Promise<void>`

### `startNotify(prop, callback)`

Подписывается на уведомления об изменении значения свойства.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `prop` | `string` | Имя свойства для подписки. |
| `callback` | `function` | Функция, которая будет вызываться с новым значением при каждом изменении. |

**Возвращает:**

- `Promise<void>`

### `stopNotify(prop)`

Отменяет подписку на уведомления для свойства.

**Параметры:**

| Имя | Тип | Описание |
|---|---|---|
| `prop` | `string` | Имя свойства для отписки. |

**Возвращает:**

- `Promise<void>`

### `auth()`

Выполняет специфичную для устройства логику аутентификации. Этот метод предназначен для переопределения в дочерних классах для устройств, требующих особой аутентификации (например, Mi Kettle).

**Возвращает:**

- `Promise<void>`
